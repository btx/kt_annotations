var h=void 0,k=!0,l=null,m=!1;function n(){return function(){}}function aa(a){return function(){return this[a]}}var o,q=this;function ba(a,b){var c=a.split("."),d=q;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)!c.length&&b!==h?d[f]=b:d=d[f]?d[f]:d[f]={}}
function ca(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function da(a){return"array"==ca(a)}function ea(a){var b=ca(a);return"array"==b||"object"==b&&"number"==typeof a.length}function t(a){return"string"==typeof a}function u(a){return"function"==ca(a)}function fa(a){var b=typeof a;return"object"==b&&a!=l||"function"==b}var ga="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),ha=0;function ia(a,b,c){return a.call.apply(a.bind,arguments)}
function ja(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ka(a,b,c){ka=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ja;return ka.apply(l,arguments)}
function la(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}function qa(a,b){function c(){}c.prototype=b.prototype;a.Qb=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ra(a,b){this.x=a;this.y=b};function sa(a){this.points=a}function ta(a){for(var b=0,c=a.length-1,d=0;d<a.length;d++)b+=(a[c].x+a[d].x)*(a[c].y-a[d].y),c=d;return b/2}
function ua(a,b){var c,d;d=c=0;for(var f,e=a.length-1,g=0;g<a.length;g++)f=a[g].x*a[e].y-a[e].x*a[g].y,c+=(a[g].x+a[e].x)*f,d+=(a[g].y+a[e].y)*f,e=g;f=6*ta(a);c=Math.abs(c/f);d=Math.abs(d/f);f=[];for(e=0;e<a.length;e++){var g=a[e],j=(0>ta(a)?-1:1)*b,i=g.x-c,p=g.y-d,y=0<j?1:0>j?-1:0,j=Math.sqrt(Math.pow(j,2)/(1+Math.pow(i/p,2)));f.push({x:g.x+Math.abs(i/p*j)*(0<i?1:0>i?-1:0)*y,y:g.y+Math.abs(j)*(0<p?1:0>p?-1:0)*y})}return f};function va(a,b,c,d){0<c?(this.x=a,this.width=c):(this.x=a+c,this.width=-c);0<d?(this.y=b,this.height=d):(this.y=b+d,this.height=-d)};function wa(a,b){this.type=a;this.geometry=b}function xa(a){return"rect"==a.type?a.geometry.width*a.geometry.height:"polygon"==a.type?Math.abs(ta(a.geometry.points)):0}function ya(a){if("rect"==a.type)return a;if("polygon"==a.type){for(var a=a.geometry.points,b=a[0].x,c=a[0].x,d=a[0].y,f=a[0].y,e=1;e<a.length;e++)a[e].x>c&&(c=a[e].x),a[e].x<b&&(b=a[e].x),a[e].y>f&&(f=a[e].y),a[e].y<d&&(d=a[e].y);return new wa("rect",new va(b,d,c-b,f-d))}}
function za(a,b){var c;c=a.geometry.points;var d=0>ta(c)?-1:1;if(4>c.length)c=ua(c,d*b);else{for(var f=c.length-1,e=1,g=[],j=0;j<c.length;j++)f=ua([c[f],c[j],c[e]],d*b),g.push(f[1]),f=j,e++,e>c.length-1&&(e=0);c=g}return new wa("polygon",new sa(c))}
function Aa(a,b){if("rect"==a.type){var c=a.geometry,d=b({x:c.x,y:c.y}),c=b({x:c.x+c.width,y:c.y+c.height});return new wa("rect",new va(d.x,d.y,c.x-d.x,c.y-d.y))}if("polygon"==a.type){var f=[];v(a.geometry.points,function(a){f.push(b(a))});return new wa("polygon",new sa(f))}}function Ba(a){return JSON.stringify(a.geometry)}window.annotorious||(window.annotorious={});window.annotorious.geometry||(window.annotorious.geometry={},window.annotorious.geometry.expand=za);function Ca(){}function Da(a){a.g=new Ea;a.sb=[];a.ra=[];a.qb=[];a.pa=[];a.aa=[];a.Sa=[];a.Aa={ha:m,ga:m};a.Ba=new Ea}function Fa(a,b){var c=a.fc(b);c||(c={ha:m,ga:m},c.set(b,c));return c}function Ga(a,b){b&&(Ha(a.qb,b),Ha(a.pa,b));Ia(a);var c=w(window,Ja,function(){0<a.pa.length?Ia(a):Na(c)})}
function Ia(a){v(a.pa,function(b){for(var c=b,d=c.offsetTop,f=c.offsetLeft,e=c.offsetWidth,g=c.offsetHeight;c.offsetParent;)c=c.offsetParent,d+=c.offsetTop,f+=c.offsetLeft;d<window.pageYOffset+window.innerHeight&&f<window.pageXOffset+window.innerWidth&&d+g>window.pageYOffset&&f+e>window.pageXOffset&&Oa(a,b)})}
function Oa(a,b){var c=a.Lb(b),d=a.jb(b),f=[],e=[];v(a.sb,function(a){c.h(a.type,a.Ia)});v(a.ra,function(a){if(a.onInitAnnotator)a.onInitAnnotator(c)});v(a.aa,function(a){a.src==d&&(c.r(a),f.push(a))});v(a.Sa,function(a){a.src==d&&(c.o(a),e.push(a))});v(f,function(b){z(a.aa,b)});v(e,function(b){z(a.Sa,b)});var g=a.Ba.get(d);g?(g.ha&&c.I(),g.ga&&c.Q(),a.Ba.remove(d)):(a.Aa.ha&&c.I(),a.Aa.ga&&c.Q());a.g.set(d,c);z(a.pa,b)}o=Ca.prototype;
o.P=function(a,b){var c=h,d=h;t(a)?(c=a,d=b):u(a)&&(d=a);c?(c=this.g.get(c))&&c.P(d):v(A(this.g),function(a){a.P(d)})};o.r=function(a,b){if(B(this,a.src)){var c=this.g.get(a.src);c?c.r(a,b):(this.aa.push(a),b&&z(this.aa,b))}};o.h=function(a,b){v(A(this.g),function(c){c.h(a,b)});this.sb.push({type:a,Ia:b})};o.fb=function(a){this.ra.push(a);v(A(this.g),function(b){if(a.onInitAnnotator)a.onInitAnnotator(b)})};o.ea=function(a,b){if(B(this,a)){var c=this.g.get(a);c&&c.ea(b)}};
function B(a,b){return Pa(a.g.J,b)?k:D(a.pa,function(c){return a.jb(c)==b})!=l}o.Q=function(a){Qa(this,a,m)};o.I=function(a){Ra(this,a,m)};o.K=function(a){Ra(this,a,k)};function Ra(a,b,c){if(b){var d=a.g.get(b);d?c?d.K():d.I():Fa(a,b).ha=c}else v(A(a.g),function(a){c?a.K():a.I()}),a.Aa.ha=c,v(A(a.Ba),function(a){a.ha=c})}o.V=function(a){if(B(this,a)&&(a=this.g.get(a)))return a.V().getName()};
o.D=function(a){if(a){var b=this.g.get(a);return b?b.D():Sa(this.aa,function(b){return b.src==a})}var c=[];v(A(this.g),function(a){Ha(c,a.D())});Ha(c,this.aa);return c};o.W=function(a){if(B(this,a)&&(a=this.g.get(a)))return Ta(a.W(),function(a){return a.getName()})};o.n=function(a){if(a){if(B(this,a.src)){var b=this.g.get(a.src);b&&b.n(a)}}else v(A(this.g),function(a){a.n()})};o.lb=function(a){this.pb(a)&&(this.qb.push(a),Oa(this,a))};
o.o=function(a){if(B(this,a.src)){var b=this.g.get(a.src);b?b.o(a):this.Sa.push(a)}};o.za=function(a){Qa(this,a,k)};function Qa(a,b,c){if(b){var d=a.g.get(b);d?c?d.za():d.Q():Fa(a,b).ga=c}else v(A(a.g),function(a){c?a.K():a.Q()}),a.Aa.ga=c,v(A(a.Ba),function(a){a.ga=c})}o.la=function(a,b){if(B(this,a)){var c=this.g.get(a);c&&c.la(b)}};function Ua(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function Va(a){if(!Wa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Xa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ya,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Za,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace($a,"&quot;"));return a}var Xa=/&/g,Ya=/</g,Za=/>/g,$a=/\"/g,Wa=/[&<>\"]/,ab={};function bb(a){return ab[a]||(ab[a]=(""+a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()}))};var G=Array.prototype,cb=G.indexOf?function(a,b,c){return G.indexOf.call(a,b,c)}:function(a,b,c){c=c==l?0:0>c?Math.max(0,a.length+c):c;if(t(a))return!t(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},v=G.forEach?function(a,b,c){G.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=t(a)?a.split(""):a,e=0;e<d;e++)e in f&&b.call(c,f[e],e,a)},Sa=G.filter?function(a,b,c){return G.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=[],e=0,g=t(a)?a.split(""):
a,j=0;j<d;j++)if(j in g){var i=g[j];b.call(c,i,j,a)&&(f[e++]=i)}return f},Ta=G.map?function(a,b,c){return G.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=Array(d),e=t(a)?a.split(""):a,g=0;g<d;g++)g in e&&(f[g]=b.call(c,e[g],g,a));return f};function D(a,b){var c;a:{c=a.length;for(var d=t(a)?a.split(""):a,f=0;f<c;f++)if(f in d&&b.call(h,d[f],f,a)){c=f;break a}c=-1}return 0>c?l:t(a)?a.charAt(c):a[c]}function z(a,b){var c=cb(a,b);0<=c&&G.splice.call(a,c,1)}
function db(a){return G.concat.apply(G,arguments)}function eb(a){if(da(a))return db(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Ha(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],f;if(da(d)||(f=ea(d))&&d.hasOwnProperty("callee"))a.push.apply(a,d);else if(f)for(var e=a.length,g=d.length,j=0;j<g;j++)a[e+j]=d[j];else a.push(d)}}function hb(a,b,c,d){G.splice.apply(a,ib(arguments,1))}
function ib(a,b,c){return 2>=arguments.length?G.slice.call(a,b):G.slice.call(a,b,c)}function jb(a,b){G.sort.call(a,b||kb)}function kb(a,b){return a>b?1:a<b?-1:0};var lb,mb,nb,ob,pb;function qb(){return q.navigator?q.navigator.userAgent:l}function rb(){return q.navigator}ob=nb=mb=lb=m;var sb;if(sb=qb()){var tb=rb();lb=0==sb.indexOf("Opera");mb=!lb&&-1!=sb.indexOf("MSIE");nb=!lb&&-1!=sb.indexOf("WebKit");ob=!lb&&!nb&&"Gecko"==tb.product}var ub=lb,H=mb,I=ob,J=nb,vb=rb();pb=-1!=(vb&&vb.platform||"").indexOf("Mac");var wb=!!rb()&&-1!=(rb().appVersion||"").indexOf("X11"),xb;
a:{var yb="",zb;if(ub&&q.opera)var Ab=q.opera.version,yb="function"==typeof Ab?Ab():Ab;else if(I?zb=/rv\:([^\);]+)(\)|;)/:H?zb=/MSIE\s+([^\);]+)(\)|;)/:J&&(zb=/WebKit\/(\S+)/),zb)var Bb=zb.exec(qb()),yb=Bb?Bb[1]:"";if(H){var Cb,Db=q.document;Cb=Db?Db.documentMode:h;if(Cb>parseFloat(yb)){xb=""+Cb;break a}}xb=yb}var Eb={};
function L(a){var b;if(!(b=Eb[a])){b=0;for(var c=Ua(""+xb).split("."),d=Ua(""+a).split("."),f=Math.max(c.length,d.length),e=0;0==b&&e<f;e++){var g=c[e]||"",j=d[e]||"",i=RegExp("(\\d*)(\\D*)","g"),p=RegExp("(\\d*)(\\D*)","g");do{var y=i.exec(g)||["","",""],r=p.exec(j)||["","",""];if(0==y[0].length&&0==r[0].length)break;b=((0==y[1].length?0:parseInt(y[1],10))<(0==r[1].length?0:parseInt(r[1],10))?-1:(0==y[1].length?0:parseInt(y[1],10))>(0==r[1].length?0:parseInt(r[1],10))?1:0)||((0==y[2].length)<(0==
r[2].length)?-1:(0==y[2].length)>(0==r[2].length)?1:0)||(y[2]<r[2]?-1:y[2]>r[2]?1:0)}while(0==b)}b=Eb[a]=0<=b}return b}var Fb={};function Ib(a){return Fb[a]||(Fb[a]=H&&!!document.documentMode&&document.documentMode>=a)};var Jb,Kb=!H||Ib(9);!I&&!H||H&&Ib(9)||I&&L("1.9.1");H&&L("9");var Lb=H||ub||J;function Mb(a){return(a=a.className)&&"function"==typeof a.split?a.split(/\s+/):[]}function Nb(a,b){var c=Mb(a),d=ib(arguments,1),d=Ob(c,d);a.className=c.join(" ");return d}function Pb(a,b){var c=Mb(a),d=ib(arguments,1);Qb(c,d);a.className=c.join(" ")}function Ob(a,b){for(var c=0,d=0;d<b.length;d++)0<=cb(a,b[d])||(a.push(b[d]),c++);return c==b.length}function Qb(a,b){for(var c=0,d=0;d<a.length;d++)0<=cb(b,a[d])&&(hb(a,d--,1),c++)}
function Rb(a,b,c){var d=Mb(a);t(b)?z(d,b):da(b)&&Qb(d,b);t(c)&&!(0<=cb(d,c))?d.push(c):da(c)&&Ob(d,c);a.className=d.join(" ")};function Sb(a,b){this.x=a!==h?a:0;this.y=b!==h?b:0};function Tb(a,b){this.width=a;this.height=b}Tb.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Tb.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Ub(a,b){for(var c in a)b.call(h,a[c],c,a)}var Vb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function Wb(a,b){for(var c,d,f=1;f<arguments.length;f++){d=arguments[f];for(c in d)a[c]=d[c];for(var e=0;e<Vb.length;e++)c=Vb[e],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Xb(a){return a?new Yb(Zb(a)):Jb||(Jb=new Yb)}function $b(a,b){Ub(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in ac?a.setAttribute(ac[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}var ac={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function bc(a){var b=!J?a.documentElement:a.body,a=a.parentWindow||a.defaultView;return new Sb(a.pageXOffset||b.scrollLeft,a.pageYOffset||b.scrollTop)}
function cc(a,b,c){var d=arguments,f=document,e=d[0],g=d[1];if(!Kb&&g&&(g.name||g.type)){e=["<",e];g.name&&e.push(' name="',Va(g.name),'"');if(g.type){e.push(' type="',Va(g.type),'"');var j={};Wb(j,g);g=j;delete g.type}e.push(">");e=e.join("")}e=f.createElement(e);g&&(t(g)?e.className=g:da(g)?Nb.apply(l,[e].concat(g)):$b(e,g));2<d.length&&dc(f,e,d,2);return e}
function dc(a,b,c,d){function f(c){c&&b.appendChild(t(c)?a.createTextNode(c):c)}for(;d<c.length;d++){var e=c[d];ea(e)&&!(fa(e)&&0<e.nodeType)?v(ec(e)?eb(e):e,f):f(e)}}function fc(a){for(var b;b=a.firstChild;)a.removeChild(b)}function gc(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)}function hc(a){return fa(a)&&1==a.nodeType}function ic(a){if(Lb)return a.parentElement;a=a.parentNode;return hc(a)?a:l}
function jc(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Zb(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ec(a){if(a&&"number"==typeof a.length){if(fa(a))return"function"==typeof a.item||"string"==typeof a.item;if(u(a))return"function"==typeof a.item}return m}function Yb(a){this.xa=a||q.document||document}o=Yb.prototype;
o.createElement=function(a){return this.xa.createElement(a)};o.createTextNode=function(a){return this.xa.createTextNode(a)};o.appendChild=function(a,b){a.appendChild(b)};o.append=function(a,b){dc(Zb(a),a,arguments,1)};o.contains=jc;function M(a,b){var c=Xb().createElement("DIV");c.innerHTML=a(b||kc,h,h);if(1==c.childNodes.length){var d=c.firstChild;if(1==d.nodeType)return d}return c}var kc={};function lc(){return k};/*
 Portions of this code are from the Dojo Toolkit, received by
 The Closure Library Authors under the BSD license. All other code is
 Copyright 2005-2009 The Closure Library Authors. All Rights Reserved.

 The "New" BSD License:

 Copyright (c) 2005-2009, The Dojo Foundation
 All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are met:

 Redistributions of source code must retain the above copyright notice, this
 list of conditions and the following disclaimer.
 Redistributions in binary form must reproduce the above copyright notice,
 this list of conditions and the following disclaimer in the documentation
 and/or other materials provided with the distribution.
 Neither the name of the Dojo Foundation nor the names of its contributors
 may be used to endorse or promote products derived from this software
 without specific prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
 FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
var N=function(){function a(a,c){if(!a)return[];if(a.constructor==Array)return a;if(!t(a))return[a];if(t(c)&&(c=t(c)?document.getElementById(c):c,!c))return[];var c=c||document,e=c.ownerDocument||c.documentElement;na=c.contentType&&"application/xml"==c.contentType||ub&&(c.doctype||"[object XMLDocument]"==e.toString())||!!e&&(H?e.xml:c.xmlVersion||e.xmlVersion);return(e=d(a)(c))&&e.Na?e:b(e)}function b(a){if(a&&a.Na)return a;var b=[];if(!a||!a.length)return b;a[0]&&b.push(a[0]);if(2>a.length)return b;
S++;if(H&&na){var c=S+"";a[0].setAttribute("_zipIdx",c);for(var d=1,e;e=a[d];d++)a[d].getAttribute("_zipIdx")!=c&&b.push(e),e.setAttribute("_zipIdx",c)}else if(H&&a.Wb)try{for(d=1;e=a[d];d++)fb(e)&&b.push(e)}catch(f){}else{a[0]&&(a[0]._zipIdx=S);for(d=1;e=a[d];d++)a[d]._zipIdx!=S&&b.push(e),e._zipIdx=S}return b}function c(a,b){if(!b)return 1;var c=Hd(a);return!b[c]?b[c]=1:0}function d(a,b){if(Ec){var c=Fc[a];if(c&&!b)return c}if(c=Gc[a])return c;var c=a.charAt(0),e=-1==a.indexOf(" ");0<=a.indexOf("#")&&
e&&(b=k);if(Ec&&!b&&-1==">~+".indexOf(c)&&(!H||-1==a.indexOf(":"))&&!(Hc&&0<=a.indexOf("."))&&-1==a.indexOf(":contains")&&-1==a.indexOf("|=")){var g=0<=">~+".indexOf(a.charAt(a.length-1))?a+" *":a;return Fc[a]=function(b){try{if(!(9==b.nodeType||e))throw"";var c=b.querySelectorAll(g);H?c.Wb=k:c.Na=k;return c}catch(f){return d(a,k)(b)}}}var i=a.split(/\s*,\s*/);return Gc[a]=2>i.length?f(a):function(a){for(var b=0,c=[],d;d=i[b++];)c=c.concat(f(d)(a));return c}}function f(a){var b=Ic(Ua(a));if(1==b.length){var c=
e(b[0]);return function(a){if(a=c(a,[]))a.Na=k;return a}}return function(a){for(var a=Ka(a),c,d,f=b.length,g,ma,Gb=0;Gb<f;Gb++){ma=[];c=b[Gb];d=a.length-1;0<d&&(g={},ma.Na=k);d=e(c);for(var i=0;c=a[i];i++)d(c,ma,g);if(!ma.length)break;a=ma}return ma}}function e(a){var b=Jc[a.ia];if(b)return b;var c=a.Gb,c=c?c.Oa:"",d=p(a,{t:1}),e="*"==a.v,f=document.getElementsByClassName;if(c)f={t:1},e&&(f.v=1),d=p(a,f),"+"==c?b=i(d):"~"==c?b=j(d):">"==c&&(b=g(d));else if(a.id)d=!a.Jb&&e?lc:p(a,{t:1,id:1}),b=function(b,
c){var e;e=Xb(b);var f=a.id;if(f=(e=t(f)?e.xa.getElementById(f):f)&&d(e))if(!(f=9==b.nodeType)){for(f=e.parentNode;f&&!(f==b);)f=f.parentNode;f=!!f}if(f)return Ka(e,c)};else if(f&&/\{\s*\[native code\]\s*\}/.test(""+f)&&a.M.length&&!Hc)var d=p(a,{t:1,M:1,id:1}),r=a.M.join(" "),b=function(a,b){for(var c=Ka(0,b),e,f=0,g=a.getElementsByClassName(r);e=g[f++];)d(e,a)&&c.push(e);return c};else!e&&!a.Jb?b=function(b,c){for(var d=Ka(0,c),e,f=0,g=b.getElementsByTagName(a.kb());e=g[f++];)d.push(e);return d}:
(d=p(a,{t:1,v:1,id:1}),b=function(b,c){for(var e=Ka(0,c),f,g=0,Gd=b.getElementsByTagName(a.kb());f=Gd[g++];)d(f,b)&&e.push(f);return e});return Jc[a.ia]=b}function g(a){a=a||lc;return function(b,d,e){for(var f=0,g=b[Kc];b=g[f++];)La(b)&&(!e||c(b,e))&&a(b,f)&&d.push(b);return d}}function j(a){return function(b,d,e){for(b=b[Ma];b;){if(La(b)){if(e&&!c(b,e))break;a(b)&&d.push(b)}b=b[Ma]}return d}}function i(a){return function(b,d,e){for(;b=b[Ma];)if(!gb||fb(b)){(!e||c(b,e))&&a(b)&&d.push(b);break}return d}}
function p(a,b){if(!a)return lc;var b=b||{},c=l;b.t||(c=oa(c,fb));b.v||"*"!=a.v&&(c=oa(c,function(b){return b&&b.tagName==a.kb()}));b.M||v(a.M,function(a,b){var d=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");c=oa(c,function(a){return d.test(a.className)});c.count=b});b.X||v(a.X,function(a){var b=a.name;Hb[b]&&(c=oa(c,Hb[b](b,a.value)))});b.Fa||v(a.Fa,function(a){var b,d=a.gb;a.type&&Lc[a.type]?b=Lc[a.type](d,a.mb):d.length&&(b=Id(d));b&&(c=oa(c,b))});b.id||a.id&&(c=oa(c,function(b){return!!b&&b.id==a.id}));
c||"default"in b||(c=lc);return c}function y(a){return K(a)%2}function r(a){return!(K(a)%2)}function K(a){var b=a.parentNode,c=0,d=b[Kc],e=a._i||-1,f=b._l||-1;if(!d)return-1;d=d.length;if(f==d&&0<=e&&0<=f)return e;b._l=d;e=-1;for(b=b.firstElementChild||b.firstChild;b;b=b[Ma])La(b)&&(b._i=++c,a===b&&(e=c));return e}function C(a){for(;a=a[Ma];)if(La(a))return m;return k}function Mc(a){for(;a=a[Jd];)if(La(a))return m;return k}function pa(a,b){return!a?"":"class"==b?a.className||"":"for"==b?a.htmlFor||
"":"style"==b?a.style.cssText||"":(na?a.getAttribute(b):a.getAttribute(b,2))||""}function fb(a){return 1==a.nodeType}function oa(a,b){return!a?b:!b?a:function(){return a.apply(window,arguments)&&b.apply(window,arguments)}}function Ic(a){function b(){0<=p&&(s.id=c(p,x).replace(/\\/g,""),p=-1);if(0<=r){var a=r==x?l:c(r,x);0>">~+".indexOf(a)?s.v=a:s.Oa=a;r=-1}0<=j&&(s.M.push(c(j+1,x).replace(/\\/g,"")),j=-1)}function c(b,d){return Ua(a.slice(b,d))}for(var a=0<=">~+".indexOf(a.slice(-1))?a+" * ":a+" ",
d=[],e=-1,f=-1,g=-1,i=-1,j=-1,p=-1,r=-1,y="",E="",C,x=0,K=a.length,s=l,F=l;y=E,E=a.charAt(x),x<K;x++)if("\\"!=y)if(s||(C=x,s={ia:l,X:[],Fa:[],M:[],v:l,Oa:l,id:l,kb:function(){return na?this.ac:this.v}},r=x),0<=e)if("]"==E){F.gb?F.mb=c(g||e+1,x):F.gb=c(e+1,x);if((e=F.mb)&&('"'==e.charAt(0)||"'"==e.charAt(0)))F.mb=e.slice(1,-1);s.Fa.push(F);F=l;e=g=-1}else"="==E&&(g=0<="|~^$*".indexOf(y)?y:"",F.type=g+E,F.gb=c(e+1,x-g.length),g=x+1);else 0<=f?")"==E&&(0<=i&&(F.value=c(f+1,x)),i=f=-1):"#"==E?(b(),p=
x+1):"."==E?(b(),j=x):":"==E?(b(),i=x):"["==E?(b(),e=x,F={}):"("==E?(0<=i&&(F={name:c(i+1,x),value:l},s.X.push(F)),f=x):" "==E&&y!=E&&(b(),0<=i&&s.X.push({name:c(i+1,x)}),s.Jb=s.X.length||s.Fa.length||s.M.length,s.mc=s.ia=c(C,x),s.ac=s.v=s.Oa?l:s.v||"*",s.v&&(s.v=s.v.toUpperCase()),d.length&&d[d.length-1].Oa&&(s.Gb=d.pop(),s.ia=s.Gb.ia+" "+s.ia),d.push(s),s=l);return d}function Ka(a,b){var c=b||[];a&&c.push(a);return c}var Hc=J&&"BackCompat"==document.compatMode,Kc=document.firstChild.children?"children":
"childNodes",na=m,Lc={"*=":function(a,b){return function(c){return 0<=pa(c,a).indexOf(b)}},"^=":function(a,b){return function(c){return 0==pa(c,a).indexOf(b)}},"$=":function(a,b){return function(c){c=" "+pa(c,a);return c.lastIndexOf(b)==c.length-b.length}},"~=":function(a,b){var c=" "+b+" ";return function(b){return 0<=(" "+pa(b,a)+" ").indexOf(c)}},"|=":function(a,b){b=" "+b;return function(c){c=" "+pa(c,a);return c==b||0==c.indexOf(b+"-")}},"=":function(a,b){return function(c){return pa(c,a)==b}}},
gb="undefined"==typeof document.firstChild.nextElementSibling,Ma=!gb?"nextElementSibling":"nextSibling",Jd=!gb?"previousElementSibling":"previousSibling",La=gb?fb:lc,Hb={checked:function(){return function(a){return a.checked||a.attributes.checked}},"first-child":function(){return Mc},"last-child":function(){return C},"only-child":function(){return function(a){return!Mc(a)||!C(a)?m:k}},empty:function(){return function(a){for(var b=a.childNodes,a=a.childNodes.length-1;0<=a;a--){var c=b[a].nodeType;
if(1===c||3==c)return m}return k}},contains:function(a,b){var c=b.charAt(0);if('"'==c||"'"==c)b=b.slice(1,-1);return function(a){return 0<=a.innerHTML.indexOf(b)}},not:function(a,b){var c=Ic(b)[0],d={t:1};"*"!=c.v&&(d.v=1);c.M.length||(d.M=1);var e=p(c,d);return function(a){return!e(a)}},"nth-child":function(a,b){if("odd"==b)return y;if("even"==b)return r;if(-1!=b.indexOf("n")){var c=b.split("n",2),d=c[0]?"-"==c[0]?-1:parseInt(c[0],10):1,e=c[1]?parseInt(c[1],10):0,f=0,g=-1;0<d?0>e?e=e%d&&d+e%d:0<
e&&(e>=d&&(f=e-e%d),e%=d):0>d&&(d*=-1,0<e&&(g=e,e%=d));if(0<d)return function(a){a=K(a);return a>=f&&(0>g||a<=g)&&a%d==e};b=e}var i=parseInt(b,10);return function(a){return K(a)==i}}},Id=H?function(a){var b=a.toLowerCase();"class"==b&&(a="className");return function(c){return na?c.getAttribute(a):c[a]||c[b]}}:function(a){return function(b){return b&&b.getAttribute&&b.hasAttribute(a)}},Jc={},Gc={},Fc={},Ec=!!document.querySelectorAll&&(!J||L("526")),S=0,Hd=H?function(a){return na?a.getAttribute("_uid")||
a.setAttribute("_uid",++S)||S:a.uniqueID}:function(a){return a._uid||(a._uid=++S)};a.X=Hb;return a}();ba("goog.dom.query",N);ba("goog.dom.query.pseudos",N.X);!H||Ib(9);var mc=!H||Ib(9),nc=H&&!L("8");!J||L("528");I&&L("1.9b")||H&&L("8")||ub&&L("9.5")||J&&L("528");!I||L("8");function oc(){}oc.prototype.Cb=m;oc.prototype.Ga=function(){this.Cb||(this.Cb=k,this.Ha())};oc.prototype.Ha=function(){this.Yb&&pc.apply(l,this.Yb)};function pc(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ea(d)?pc.apply(l,d):d&&"function"==typeof d.Ga&&d.Ga()}};function O(a,b){this.type=a;this.currentTarget=this.target=b}qa(O,oc);O.prototype.Ha=function(){delete this.type;delete this.target;delete this.currentTarget};O.prototype.ob=m;O.prototype.Ob=k;O.prototype.preventDefault=function(){this.Ob=m};var Ja="scroll";function qc(a){qc[" "](a);return a}qc[" "]=n();function rc(a,b){a&&this.init(a,b)}qa(rc,O);o=rc.prototype;o.target=l;o.relatedTarget=l;o.offsetX=0;o.offsetY=0;o.clientX=0;o.clientY=0;o.screenX=0;o.screenY=0;o.button=0;o.keyCode=0;o.charCode=0;o.ctrlKey=m;o.altKey=m;o.shiftKey=m;o.metaKey=m;o.fa=l;
o.init=function(a,b){var c=this.type=a.type;O.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(I){var f;a:{try{qc(d.nodeName);f=k;break a}catch(e){}f=m}f||(d=l)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=J||a.offsetX!==h?a.offsetX:a.layerX;this.offsetY=J||a.offsetY!==h?a.offsetY:a.layerY;this.clientX=a.clientX!==h?a.clientX:a.pageX;this.clientY=a.clientY!==h?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.fa=a;delete this.Ob;delete this.ob};o.preventDefault=function(){rc.Qb.preventDefault.call(this);var a=this.fa;if(a.preventDefault)a.preventDefault();else if(a.returnValue=m,nc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};
o.Zb=aa("fa");o.Ha=function(){rc.Qb.Ha.call(this);this.relatedTarget=this.currentTarget=this.target=this.fa=l};function sc(){}var tc=0;o=sc.prototype;o.key=0;o.ka=m;o.Ab=m;o.init=function(a,b,c,d,f,e){if(u(a))this.Ib=k;else if(a&&a.handleEvent&&u(a.handleEvent))this.Ib=m;else throw Error("Invalid listener argument");this.Ja=a;this.Mb=b;this.src=c;this.type=d;this.capture=!!f;this.Ia=e;this.Ab=m;this.key=++tc;this.ka=m};o.handleEvent=function(a){return this.Ib?this.Ja.call(this.Ia||this.src,a):this.Ja.handleEvent.call(this.Ja,a)};var uc={},P={},vc={},wc={};
function w(a,b,c,d,f){if(b){if(da(b)){for(var e=0;e<b.length;e++)w(a,b[e],c,d,f);return l}var d=!!d,g=P;b in g||(g[b]={j:0,Y:0});g=g[b];d in g||(g[d]={j:0,Y:0},g.j++);var g=g[d],j=a[ga]||(a[ga]=++ha),i;g.Y++;if(g[j]){i=g[j];for(e=0;e<i.length;e++)if(g=i[e],g.Ja==c&&g.Ia==f){if(g.ka)break;return i[e].key}}else i=g[j]=[],g.j++;e=xc();e.src=a;g=new sc;g.init(c,e,a,b,d,f);c=g.key;e.key=c;i.push(g);uc[c]=g;vc[j]||(vc[j]=[]);vc[j].push(g);a.addEventListener?(a==q||!a.Xb)&&a.addEventListener(b,e,d):a.attachEvent(b in
wc?wc[b]:wc[b]="on"+b,e);return c}throw Error("Invalid event type");}function xc(){var a=yc,b=mc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}
function Na(a){if(uc[a]){var b=uc[a];if(!b.ka){var c=b.src,d=b.type,f=b.Mb,e=b.capture;c.removeEventListener?(c==q||!c.Xb)&&c.removeEventListener(d,f,e):c.detachEvent&&c.detachEvent(d in wc?wc[d]:wc[d]="on"+d,f);c=c[ga]||(c[ga]=++ha);f=P[d][e][c];if(vc[c]){var g=vc[c];z(g,b);0==g.length&&delete vc[c]}b.ka=k;f.Kb=k;zc(d,e,c,f);delete uc[a]}}}
function zc(a,b,c,d){if(!d.Ka&&d.Kb){for(var f=0,e=0;f<d.length;f++)d[f].ka?d[f].Mb.src=l:(f!=e&&(d[e]=d[f]),e++);d.length=e;d.Kb=m;0==e&&(delete P[a][b][c],P[a][b].j--,0==P[a][b].j&&(delete P[a][b],P[a].j--),0==P[a].j&&delete P[a])}}function Ac(a,b,c,d,f){var e=1,b=b[ga]||(b[ga]=++ha);if(a[b]){a.Y--;a=a[b];a.Ka?a.Ka++:a.Ka=1;try{for(var g=a.length,j=0;j<g;j++){var i=a[j];i&&!i.ka&&(e&=Bc(i,f)!==m)}}finally{a.Ka--,zc(c,d,b,a)}}return Boolean(e)}
function Bc(a,b){var c=a.handleEvent(b);a.Ab&&Na(a.key);return c}
function yc(a,b){if(!uc[a])return k;var c=uc[a],d=c.type,f=P;if(!(d in f))return k;var f=f[d],e,g;if(!mc){var j;if(!(j=b))a:{j=["window","event"];for(var i=q;e=j.shift();)if(i[e]!=l)i=i[e];else{j=l;break a}j=i}e=j;j=k in f;i=m in f;if(j){if(0>e.keyCode||e.returnValue!=h)return k;a:{var p=m;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(y){p=k}if(p||e.returnValue==h)e.returnValue=k}}p=new rc;p.init(e,this);e=k;try{if(j){for(var r=[],K=p.currentTarget;K;K=K.parentNode)r.push(K);g=f[k];g.Y=g.j;for(var C=
r.length-1;!p.ob&&0<=C&&g.Y;C--)p.currentTarget=r[C],e&=Ac(g,r[C],d,k,p);if(i){g=f[m];g.Y=g.j;for(C=0;!p.ob&&C<r.length&&g.Y;C++)p.currentTarget=r[C],e&=Ac(g,r[C],d,m,p)}}else e=Bc(c,p)}finally{r&&(r.length=0),p.Ga()}return e}d=new rc(b,this);try{e=Bc(c,d)}finally{d.Ga()}return e};function Cc(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}Cc.prototype.contains=function(a){return!this||!a?m:a instanceof Cc?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function Dc(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}Dc.prototype.contains=function(a){return a instanceof Dc?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};function Q(a,b,c){t(b)?Nc(a,c,b):Ub(b,la(Nc,a))}function Nc(a,b,c){a.style[bb(c)]=b}function R(a,b){var c=Zb(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,l))?c[b]||c.getPropertyValue(b):""}function Oc(a,b){return a.currentStyle?a.currentStyle[b]:l}function Pc(a,b){return R(a,b)||Oc(a,b)||a.style&&a.style[b]}function Qc(a,b,c){var d,f=I&&(pb||wb)&&L("1.9");b instanceof Sb?(d=b.x,b=b.y):(d=b,b=c);a.style.left=Rc(d,f);a.style.top=Rc(b,f)}
function Sc(a){var b=a.getBoundingClientRect();H&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function Tc(a){if(H&&!Ib(8))return a.offsetParent;for(var b=Zb(a),c=Pc(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=Pc(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return l}
function Uc(a){var b,c=Zb(a),d=Pc(a,"position"),f=I&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),e=new Sb(0,0),g;b=c?9==c.nodeType?c:Zb(c):document;if(g=H)if(g=!Ib(9))Xb(b),g=m;g=g?b.body:b.documentElement;if(a==g)return e;if(a.getBoundingClientRect)b=Sc(a),a=Xb(c),a=bc(a.xa),e.x=b.left+a.x,e.y=b.top+a.y;else if(c.getBoxObjectFor&&!f)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),e.x=b.screenX-a.screenX,e.y=b.screenY-a.screenY;else{b=
a;do{e.x+=b.offsetLeft;e.y+=b.offsetTop;b!=a&&(e.x+=b.clientLeft||0,e.y+=b.clientTop||0);if(J&&"fixed"==Pc(b,"position")){e.x+=c.body.scrollLeft;e.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(ub||J&&"absolute"==d)e.y-=c.body.offsetTop;for(b=a;(b=Tc(b))&&b!=c.body&&b!=g;)if(e.x-=b.scrollLeft,!ub||"TR"!=b.tagName)e.y-=b.scrollTop}return e}function Vc(a,b){var c=Wc(a),d=Wc(b);return new Sb(c.x-d.x,c.y-d.y)}
function Wc(a){var b=new Sb;if(1==a.nodeType)if(a.getBoundingClientRect)a=Sc(a),b.x=a.left,b.y=a.top;else{var c;c=Xb(a);c=bc(c.xa);a=Uc(a);b.x=a.x-c.x;b.y=a.y-c.y}else{c=u(a.Zb);var d=a;a.targetTouches?d=a.targetTouches[0]:c&&a.fa.targetTouches&&(d=a.fa.targetTouches[0]);b.x=d.clientX;b.y=d.clientY}return b}function Xc(a,b,c){if(b instanceof Tb)c=b.height,b=b.width;else if(c==h)throw Error("missing height argument");a.style.width=Rc(b,k);a.style.height=Rc(c,k)}
function Rc(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function Yc(a){if("none"!=Pc(a,"display"))return Zc(a);var b=a.style,c=b.display,d=b.visibility,f=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=Zc(a);b.display=c;b.position=f;b.visibility=d;return a}function Zc(a){var b=a.offsetWidth,c=a.offsetHeight,d=J&&!b&&!c;return(b===h||d)&&a.getBoundingClientRect?(a=Sc(a),new Tb(a.right-a.left,a.bottom-a.top)):new Tb(b,c)}
function $c(a){var b=Uc(a),a=Yc(a);return new Dc(b.x,b.y,a.width,a.height)}function T(a,b){var c=a.style;"opacity"in c?c.opacity=b:"MozOpacity"in c?c.MozOpacity=b:"filter"in c&&(c.filter=""===b?"":"alpha(opacity="+100*b+")")}function U(a,b){a.style.display=b?"":"none"}function ad(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var f=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return f}
function bd(a,b){if(H){var c=ad(a,Oc(a,b+"Left")),d=ad(a,Oc(a,b+"Right")),f=ad(a,Oc(a,b+"Top")),e=ad(a,Oc(a,b+"Bottom"));return new Cc(f,d,e,c)}c=R(a,b+"Left");d=R(a,b+"Right");f=R(a,b+"Top");e=R(a,b+"Bottom");return new Cc(parseFloat(f),parseFloat(d),parseFloat(e),parseFloat(c))};function cd(a,b){var c;this.S=a;this.l=new dd;this.va=[];this.cb=k;var d=$c(a);this.element=cc("div","annotorious-annotationlayer");Q(this.element,"position","relative");Q(this.element,"display","inline-block");ed(a,this.element);Xc(this.element,d.width,d.height);gc(this.element,a);this.element.appendChild(a);c=M(fd,{width:d.width,height:d.height});Nb(c,"annotorious-item-unfocus");this.element.appendChild(c);this.d=M(fd,{width:d.width,height:d.height});U(this.d,m);this.element.appendChild(this.d);
this.popup=b?b:new V(this);d=new gd;d.init(this.d,this);this.va.push(d);this.ba=d;this.editor=new W(this);this.m=new hd(c,this.popup,this);this.tb=new id(this,this.element);var f=this;w(this.element,"mouseover",function(a){a=a.relatedTarget;if(!a||!jc(f.element,a))f.l.fireEvent(jd),Rb(c,"annotorious-item-unfocus","annotorious-item-focus")});w(this.element,"mouseout",function(a){a=a.relatedTarget;if(!a||!jc(f.element,a))f.l.fireEvent(kd),Rb(c,"annotorious-item-focus","annotorious-item-unfocus")});
w(c,"mousedown",function(a){f.cb&&(U(f.d,k),f.m.n(h),f.ba.startSelection(a.offsetX,a.offsetY))});this.l.h(ld,function(a){a=a.viewportBounds;f.editor.Z({x:a.left+f.S.offsetLeft,y:a.bottom+4+f.S.offsetTop});f.editor.open()});this.l.h(md,function(){U(f.d,m);f.ba.stopSelection()})}
function ed(a,b){function c(c,d){Q(b,"margin-"+c,d+"px");Q(a,"margin-"+c,0);Q(a,"padding-"+c,0)}var d=bd(a,"margin"),f=bd(a,"padding");(0!=d.top||0!=f.top)&&c("top",d.top+f.top);(0!=d.right||0!=f.right)&&c("right",d.right+f.right);(0!=d.bottom||0!=f.bottom)&&c("bottom",d.bottom+f.bottom);(0!=d.left||0!=f.left)&&c("left",d.left+f.left)}o=cd.prototype;
o.Db=function(a){this.m.o(a);var b=D(this.va,function(b){return b.getSupportedShapeType()==a.shapes[0].type});if(b){U(this.d,k);this.m.n(h);var c=this.d.getContext("2d"),d=a.shapes[0],f=this,d="pixel"==d.units?d:Aa(d,function(a){return f.ya(a)});b.drawShape(c,d)}b=ya(a.shapes[0]).geometry;b="pixel"==a.shapes[0].units?{x:b.x,y:b.y+b.height}:this.ya({x:b.x,y:b.y+b.height});this.editor.Z({x:b.x+this.S.offsetLeft,y:b.y+4+this.S.offsetTop});this.editor.open(a)};o.r=function(a,b){this.m.r(a,b)};
o.h=function(a,b){this.l.h(a,b)};o.ea=function(a){a.init(this,this.d);this.va.push(a)};o.fireEvent=function(a,b){this.l.fireEvent(a,b)};o.ya=function(a){var b=Yc(this.S);return{x:a.x*b.width,y:a.y*b.height}};o.V=aa("ba");o.D=function(){return this.m.D()};o.W=aa("va");o.getItem=function(){return{src:nd(this.S)}};function nd(a){var b=a.getAttribute("data-original");return b?b:a.src}o.n=function(a){this.m.n(a)};o.o=function(a){this.m.o(a)};o.ja=function(a,b){this.l.ja(a,b)};
o.la=function(a){(this.ba=D(this.va,function(b){return b.getName()==a}))||console.log('WARNING: selector "'+a+'" not available')};o.K=function(){this.cb=k};o.I=function(){this.cb=m;var a=this.tb;a.Va();delete a.xb;delete a.wb;delete a.bb;delete a.ab;(a=a.element)&&a.parentNode&&a.parentNode.removeChild(a);delete this.tb};o.P=n();o.stopSelection=function(a){U(this.d,m);this.ba.stopSelection();a&&this.m.r(a)};o.Pa=function(a){var b=Yc(this.S);return{x:a.x/b.width,y:a.y/b.height}};
cd.prototype.fireEvent=cd.prototype.fireEvent;cd.prototype.toItemCoordinates=cd.prototype.Pa;function Ea(a,b){this.J={};this.k=[];var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){var f;if(a instanceof Ea)od(a),f=a.k.concat(),d=A(a);else{var c=[],e=0;for(f in a)c[e++]=f;f=c;c=[];e=0;for(d in a)c[e++]=a[d];d=c}for(c=0;c<f.length;c++)this.set(f[c],d[c])}}o=Ea.prototype;o.j=0;function A(a){od(a);for(var b=[],c=0;c<a.k.length;c++)b.push(a.J[a.k[c]]);return b}
o.clear=function(){this.J={};this.j=this.k.length=0};o.remove=function(a){return Pa(this.J,a)?(delete this.J[a],this.j--,this.k.length>2*this.j&&od(this),k):m};function od(a){if(a.j!=a.k.length){for(var b=0,c=0;b<a.k.length;){var d=a.k[b];Pa(a.J,d)&&(a.k[c++]=d);b++}a.k.length=c}if(a.j!=a.k.length){for(var f={},c=b=0;b<a.k.length;)d=a.k[b],Pa(f,d)||(a.k[c++]=d,f[d]=1),b++;a.k.length=c}}o.get=function(a,b){return Pa(this.J,a)?this.J[a]:b};
o.set=function(a,b){Pa(this.J,a)||(this.j++,this.k.push(a));this.J[a]=b};function Pa(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function pd(){Da(this)}qa(pd,Ca);pd.prototype.jb=function(a){return nd(a)};pd.prototype.init=function(){Ga(this,N("img.annotatable",document))};pd.prototype.Lb=function(a){return new cd(a)};pd.prototype.pb=function(a){return hc(a)?"IMG"==a.tagName:m};function hd(a,b,c){this.H=a;this.A=b;this.f=c;this.$=[];this.T=[];this.w=this.H.getContext("2d");this.da=k;this.Ya=m;var d=this;w(this.H,"mousemove",function(a){if(d.da){var b=qd(d,a.offsetX,a.offsetY);b?(d.Ya=m,d.c?d.c!=b&&(d.da=m,X(d.A)):(d.c=b,rd(d),d.f.fireEvent(sd,{U:d.c,mouseEvent:a}))):!d.Ya&&d.c&&(d.da=m,X(d.A))}else d.ma=a});c.h(kd,function(){delete d.c;d.da=k});c.h(td,function(){if(!d.da&&d.ma){var a=d.c;d.c=qd(d,d.ma.offsetX,d.ma.offsetY);d.da=k;a!=d.c?(rd(d),d.f.fireEvent(ud,{U:a,mouseEvent:d.ma}),
d.f.fireEvent(sd,{U:d.c,mouseEvent:d.ma})):d.c&&vd(d.A)}else rd(d)})}hd.prototype.r=function(a,b){b&&(b==this.c&&delete this.c,z(this.$,b),delete this.T[Ba(b.shapes[0])]);this.$.push(a);var c=a.shapes[0];if("pixel"!=c.units)var d=this,c=Aa(c,function(a){return d.f.ya(a)});this.T[Ba(a.shapes[0])]=c;rd(this)};hd.prototype.o=function(a){a==this.c&&delete this.c;z(this.$,a);delete this.T[Ba(a.shapes[0])];rd(this)};hd.prototype.D=function(){return eb(this.$)};
hd.prototype.n=function(a){(this.c=a)?this.Ya=k:X(this.A);rd(this)};function qd(a,b,c){a=wd(a,b,c);if(0<a.length)return a[0]}
function wd(a,b,c){var d=[];v(a.$,function(f){var e;e=a.T[Ba(f.shapes[0])];if("rect"==e.type)e=b<e.geometry.x||c<e.geometry.y||b>e.geometry.x+e.geometry.width||c>e.geometry.y+e.geometry.height?m:k;else if("polygon"==e.type){e=e.geometry.points;for(var g=m,j=e.length-1,i=0;i<e.length;i++)e[i].y>c!=e[j].y>c&&b<(e[j].x-e[i].x)*(c-e[i].y)/(e[j].y-e[i].y)+e[i].x&&(g=!g),j=i;e=g}else e=m;e&&d.push(f)});jb(d,function(a,b){return xa(a.shapes[0])>xa(b.shapes[0])});return d}
function xd(a,b,c){var d=D(a.f.W(),function(a){return a.getSupportedShapeType()==b.type});d?d.drawShape(a.w,b,c):console.log("WARNING unsupported shape type: "+b.type)}function rd(a){a.w.clearRect(0,0,a.H.width,a.H.height);v(a.$,function(b){xd(a,a.T[Ba(b.shapes[0])])});if(a.c){var b=a.T[Ba(a.c.shapes[0])];xd(a,b,k);b=ya(b).geometry;a.A.show(a.c,{x:b.x,y:b.y+b.height+5})}};var yd={};
function zd(a){this.O=a;this.L=a.div;var b=parseInt(R(this.L,"width")),c=parseInt(R(this.L,"height"));this.l=new dd;this.element=cc("div","annotorious-annotationlayer");Q(this.element,"position","relative");Xc(this.element,b,c);gc(this.element,this.L);this.element.appendChild(this.L);this.ta=M(Ad,{nb:"Click and Drag"});Q(this.ta,"z-index",9998);T(this.ta,0);this.element.appendChild(this.ta);this.popup=new V(this);this.m=new Bd(a,this);this.d=M(fd,{width:b,height:c});U(this.d,m);Q(this.d,"z-index",
9999);this.element.appendChild(this.d);this.ua=new gd;this.ua.init(this.d,this);this.Ea=h;this.editor=new W(this);Q(this.editor.element,"z-index",1E4);var d=this;w(this.element,"mouseover",function(a){a=a.relatedTarget;(!a||!jc(d.element,a))&&d.l.fireEvent(jd)});w(this.element,"mouseout",function(a){a=a.relatedTarget;(!a||!jc(d.element,a))&&d.l.fireEvent(kd)});w(this.d,"mousedown",function(a){var b=Wc(d.L);d.ua.startSelection(a.clientX-b.x,a.clientY-b.y)});this.l.h(ld,function(a){Q(d.d,"pointer-events",
"none");a=a.viewportBounds;d.editor.Z({x:a.left+d.L.offsetLeft,y:a.bottom+4+d.L.offsetTop});d.editor.open()});this.l.h(md,function(){d.stopSelection()})}o=zd.prototype;o.K=n();o.I=n();o.P=function(a){Q(this.d,"pointer-events","auto");var b=this;U(this.d,k);T(this.ta,0.8);window.setTimeout(function(){T(b.ta,0)},2E3);a&&(this.Ea=a)};
o.Db=function(a){this.m.o(a);var b=this.ua,c=this;if(b){U(this.d,k);this.m.n(h);var d=this.d.getContext("2d"),f=Aa(a.shapes[0],function(a){return c.ya(a)});b.drawShape(d,f);b=ya(f).geometry;this.editor.Z({x:b.x+this.L.offsetLeft,y:b.y+b.height+4+this.L.offsetTop});this.editor.open(a)}};o.r=function(a){this.m.r(a)};o.h=function(a,b){this.l.h(a,b)};o.ea=n();o.fireEvent=function(a,b){this.l.fireEvent(a,b)};
o.ya=function(a){a=this.O.getViewPortPxFromLonLat(new OpenLayers.LonLat(a.x,a.y));return{x:a.x,y:a.y}};o.V=aa("ua");o.D=n();o.W=n();o.getItem=function(){return{src:"map://openlayers/something"}};o.n=function(a){this.m.n(a)};o.o=function(a){this.m.o(a)};o.ja=function(a,b){this.l.ja(a,b)};o.la=n();o.stopSelection=function(a){U(this.d,m);this.Ea&&(this.Ea(),delete this.Ea);this.ua.stopSelection();a&&this.m.r(a)};
o.Pa=function(a){a=this.O.getLonLatFromPixel(new OpenLayers.Pixel(a.x,a.y));return{x:a.lon,y:a.lat}};function Cd(){Da(this)}qa(Cd,Ca);Cd.prototype.jb=function(){return"map://openlayers/something"};Cd.prototype.init=function(){Ga(this)};Cd.prototype.Lb=function(a){return new zd(a)};Cd.prototype.pb=function(a){return a instanceof OpenLayers.Map};function Bd(a,b){this.O=a;this.Da=$c(b.element);this.A=b.popup;Q(this.A.element,"z-index",99E3);this.qa=[];this.Ra=new OpenLayers.Layer.Boxes("Annotorious");this.O.addLayer(this.Ra);var c=this;this.O.events.register("move",this.O,function(){c.ca&&c.A.Z(Dd(c))});b.h(td,function(){c.Za==c.ca?vd(c.A):Ed(c,c.Za,c.ca)})}
function Dd(a){var b=a.ca.La.div,c=parseInt(b.style[bb("height")]||"",10),d=$c(a.A.element),b=Vc(b,a.O.div);b.y=b.y+c+5;0>b.x&&(b.x=0);b.x+d.width>a.Da.width&&(b.x=a.Da.width-d.width);b.y+d.height>a.Da.height&&(b.y=a.Da.height-d.height);return b}function Ed(a,b,c){b?(Vc(b.La.div,a.O.div),bb("height"),Q(b.Hb,"border-color","#fff000"),a.ca=b,a.A.show(b.U,Dd(a))):delete a.ca;c&&Q(c.Hb,"border-color","#fff")}
Bd.prototype.r=function(a){var b=a.shapes[0].geometry,b=new OpenLayers.Marker.Box(new OpenLayers.Bounds(b.x,b.y,b.x+b.width,b.y+b.height));Nb(b.div,"annotorious-ol-boxmarker-outer");Q(b.div,"border",l);var c=cc("div","annotorious-ol-boxmarker-inner");Xc(c,"100%","100%");b.div.appendChild(c);var d={U:a,La:b,Hb:c},f=this;w(c,"mouseover",function(){f.ca||Ed(f,d);f.Za=d});w(c,"mouseout",function(){delete f.Za;X(f.A)});this.qa.push(d);jb(this.qa,function(a,b){return xa(b.U.shapes[0])-xa(a.U.shapes[0])});
var e=1E4;v(this.qa,function(a){Q(a.La.div,"z-index",e);e++});this.Ra.addMarker(b)};Bd.prototype.o=function(a){var b=D(this.qa,function(b){return b.U==a});b&&(z(this.qa,b),this.Ra.removeMarker(b.La))};Bd.prototype.D=n();Bd.prototype.n=function(a){a||X(this.A)};function gd(){}o=gd.prototype;o.init=function(a,b){this.H=a;this.f=b;this.w=a.getContext("2d");this.w.lineWidth=1;this.Wa=m};
o.Qa=function(){var a=this;this.$a=w(this.H,"mousemove",function(b){if(a.Wa){a.B={x:b.offsetX,y:b.offsetY};a.w.clearRect(0,0,a.H.width,a.H.height);var b=a.B.x-a.e.x,c=a.B.y-a.e.y;a.w.strokeStyle="#000000";a.w.strokeRect(a.e.x+0.5,a.e.y+0.5,b,c);a.w.strokeStyle="#ffffff";0<b&&0<c?a.w.strokeRect(a.e.x+1.5,a.e.y+1.5,b-2,c-2):0<b&&0>c?a.w.strokeRect(a.e.x+1.5,a.e.y-0.5,b-2,c+2):0>b&&0>c?a.w.strokeRect(a.e.x-0.5,a.e.y-0.5,b+2,c+2):a.w.strokeRect(a.e.x-0.5,a.e.y+1.5,b+2,c-2)}});this.yb=w(this.H,"mouseup",
function(b){a.Wa=m;var c=a.getShape();c?a.f.fireEvent(ld,{mouseEvent:b,shape:c,viewportBounds:a.getViewportBounds()}):a.f.fireEvent(md)})};o.Va=function(){this.$a&&(Na(this.$a),delete this.$a);this.yb&&(Na(this.yb),delete this.ec)};o.getName=function(){return"rect_drag"};o.getSupportedShapeType=function(){return"rect"};o.startSelection=function(a,b){this.Wa=k;this.Qa();this.e=new ra(a,b);this.f.fireEvent(Fd,{offsetX:a,offsetY:b});Q(document.body,"-webkit-user-select","none")};
o.stopSelection=function(){this.Va();this.w.clearRect(0,0,this.H.width,this.H.height);Q(document.body,"-webkit-user-select","auto");delete this.B};o.getShape=function(){if(this.B&&3<Math.abs(this.B.x-this.e.x)&&3<Math.abs(this.B.y-this.e.y)){var a=this.getViewportBounds(),b=this.f.Pa({x:a.left,y:a.top}),a=this.f.Pa({x:a.right-1,y:a.bottom-1});return new wa("rect",new va(b.x,b.y,a.x-b.x,a.y-b.y))}};
o.getViewportBounds=function(){var a,b;this.B.x>this.e.x?(a=this.B.x,b=this.e.x):(a=this.e.x,b=this.B.x);var c,d;this.B.y>this.e.y?(c=this.e.y,d=this.B.y):(c=this.B.y,d=this.e.y);return{top:c,right:a,bottom:d,left:b}};o.drawShape=function(a,b,c){if("rect"==b.type){var d;c?(c="#fff000",d=1.2):(c="#ffffff",d=1);b=b.geometry;a.strokeStyle="#000000";a.lineWidth=d;a.strokeRect(b.x+0.5,b.y+0.5,b.width+1,b.height+1);a.strokeStyle=c;a.strokeRect(b.x+1.5,b.y+1.5,b.width-1,b.height-1)}};function Kd(a,b,c){this.src=a;this.text=b;this.shapes=[c];this.context=document.URL};function Ld(a){window.addEventListener?window.addEventListener("load",a):window.attachEvent&&window.attachEvent("onload",a)};function Y(){this.z=[new pd];yd&&this.z.push(new Cd);this.ra=[];var a=this;Ld(function(){v(a.z,function(a){a.init()});v(a.ra,function(b){b.initPlugin&&b.initPlugin(a);v(a.z,function(a){a.fb(b)})})})}function Z(a,b){return D(a.z,function(a){return B(a,b)})}o=Y.prototype;o.P=function(a,b){var c=h,d=h;t(a)?(c=a,d=b):u(a)&&(d=a);if(c){var f=Z(this,c);f&&f.P(c,d)}else v(this.z,function(a){a.P(d)})};o.r=function(a,b){var c=Z(this,a.src);c&&c.r(a,b)};o.h=function(a,b){v(this.z,function(c){c.h(a,b)})};
o.fb=function(a,b){try{this.ra.push(new window.annotorious.plugin[a](b))}catch(c){console.log("Could not load plugin: "+a)}};o.V=function(a){var b=Z(this,a);if(b)return b.V(a)};o.D=function(a){if(a){var b=Z(this,a);return b?b.D(a):[]}var c=[];v(this.z,function(a){Ha(c,a.D())});return c};o.W=function(a){var b=Z(this,a);return b?b.W(a):[]};o.Q=function(a){if(a){var b=Z(this,a);b&&b.Q(a)}else v(this.z,function(a){a.Q()})};o.I=function(a){if(a){var b=Z(this,a);b&&b.I(a)}else v(this.z,function(a){a.I()})};
o.n=function(a){if(a){var b=Z(this,a.src);b&&b.n(a)}else v(this.z,function(a){a.n()})};o.lb=function(a){var b=D(this.z,function(b){return b.pb(a)});if(b)b.lb(a);else throw"Error: Annotorious does not support this media type in the current version or build configuration.";};o.bc=function(a){var b=this;v(this.D(a),function(a){b.o(a)})};o.o=function(a){var b=Z(this,a.src);b&&b.o(a)};o.ea=function(a,b){var c=Z(this,a);c&&c.ea(a,b)};o.la=function(a,b){var c=Z(this,a);c&&c.la(a,b)};
o.cc=function(a){a?this.K():this.I()};o.za=function(a){if(a){var b=Z(this,a);b&&b.za(a)}else v(this.z,function(a){a.za()})};o.K=function(a){if(a){var b=Z(this,item_url);b&&b.K(a)}else v(this.z,function(a){a.K()})};window.anno=new Y;Y.prototype.activateSelector=Y.prototype.P;Y.prototype.addAnnotation=Y.prototype.r;Y.prototype.addHandler=Y.prototype.h;Y.prototype.addPlugin=Y.prototype.fb;Y.prototype.getActiveSelector=Y.prototype.V;Y.prototype.getAnnotations=Y.prototype.D;
Y.prototype.getAvailableSelectors=Y.prototype.W;Y.prototype.hideAnnotations=Y.prototype.Q;Y.prototype.hideSelectionWidget=Y.prototype.I;Y.prototype.highlightAnnotation=Y.prototype.n;Y.prototype.makeAnnotatable=Y.prototype.lb;Y.prototype.removeAll=Y.prototype.bc;Y.prototype.removeAnnotation=Y.prototype.o;Y.prototype.setActiveSelector=Y.prototype.la;Y.prototype.showAnnotations=Y.prototype.za;Y.prototype.showSelectionWidget=Y.prototype.K;Y.prototype.addSelector=Y.prototype.ea;
Y.prototype.setSelectionEnabled=Y.prototype.cc;var Md;(Md="ScriptEngine"in q&&"JScript"==q.ScriptEngine())&&(q.ScriptEngineMajorVersion(),q.ScriptEngineMinorVersion(),q.ScriptEngineBuildVersion());function Nd(a,b){this.C=Md?[]:"";a!=l&&this.append.apply(this,arguments)}Nd.prototype.set=function(a){this.clear();this.append(a)};Md?(Nd.prototype.hb=0,Nd.prototype.append=function(a,b,c){b==l?this.C[this.hb++]=a:(this.C.push.apply(this.C,arguments),this.hb=this.C.length);return this}):Nd.prototype.append=function(a,b,c){this.C+=a;if(b!=l)for(var d=1;d<arguments.length;d++)this.C+=arguments[d];return this};Nd.prototype.clear=function(){Md?this.hb=this.C.length=0:this.C=""};
Nd.prototype.toString=function(){if(Md){var a=this.C.join("");this.clear();a&&this.append(a);return a}return this.C};/*
 Portions of this code are from the google-caja project, received by
 Google under the Apache license (http://code.google.com/p/google-caja/).
 All other code is Copyright 2009 Google, Inc. All Rights Reserved.

 // Copyright (C) 2006 Google Inc.
 //
 // Licensed under the Apache License, Version 2.0 (the "License");
 // you may not use this file except in compliance with the License.
 // You may obtain a copy of the License at
 //
 //      http://www.apache.org/licenses/LICENSE-2.0
 //
 // Unless required by applicable law or agreed to in writing, software
 // distributed under the License is distributed on an "AS IS" BASIS,
 // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 // See the License for the specific language governing permissions and
 // limitations under the License.

*/
function Od(){}
var Pd={kc:"<",jc:">",gc:"&",lc:"\u00a0",nc:'"',hc:"'"},$={a:0,abbr:0,acronym:0,address:0,applet:16,area:2,b:0,base:18,basefont:18,bdo:0,big:0,blockquote:0,body:49,br:2,button:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,dd:1,del:0,dfn:0,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,font:0,form:0,frame:18,frameset:16,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:49,hr:2,html:49,i:0,iframe:20,img:2,input:2,ins:0,isindex:18,kbd:0,label:0,legend:0,li:1,link:18,map:0,menu:0,meta:18,noframes:20,noscript:20,object:16,
ol:0,optgroup:0,option:1,p:1,param:18,pre:0,q:0,s:0,samp:0,script:20,select:0,small:0,span:0,strike:0,strong:0,style:20,sub:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,title:24,tr:1,tt:0,u:0,ul:0,"var":0},Qd=/&/g,Rd=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,Sd=/</g,Td=/>/g,Ud=/\"/g,Vd=/=/g,Wd=/\0/g,Xd=/&(#\d+|#x[0-9A-Fa-f]+|\w+);/g,Yd=/^#(\d+)$/,Zd=/^#x([0-9A-Fa-f]+)$/,$d=RegExp("^\\s*(?:(?:([a-z][a-z-]*)(\\s*=\\s*(\"[^\"]*\"|'[^']*'|(?=[a-z][a-z-]*\\s*=)|[^>\"'\\s]*))?)|(/?>)|[^a-z\\s>]+)",
"i"),ae=RegExp("^(?:&(\\#[0-9]+|\\#[x][0-9a-f]+|\\w+);|<[!]--[\\s\\S]*?--\>|<!\\w[^>]*>|<\\?[^>*]*>|<(/)?([a-z][a-z0-9]*)|([^<&>]+)|([<&>]))","i");
Od.prototype.parse=function(a,b){var c=l,d=m,f=[],e,g,j;a.F=[];for(a.R=m;b;){var i=b.match(d?$d:ae),b=b.substring(i[0].length);if(d)if(i[1]){var p=i[1].toLowerCase();if(i[2]){i=i[3];switch(i.charCodeAt(0)){case 34:case 39:i=i.substring(1,i.length-1)}i=i.replace(Wd,"").replace(Xd,ka(this.$b,this))}else i=p;f.push(p,i)}else i[4]&&(g!==h&&(j?a.Pb&&a.Pb(e,f):a.Eb&&a.Eb(e)),j&&g&12&&(c=c===l?b.toLowerCase():c.substring(c.length-b.length),d=c.indexOf("</"+e),0>d&&(d=b.length),g&4?a.Bb&&a.Bb(b.substring(0,
d)):a.Nb&&a.Nb(b.substring(0,d).replace(Rd,"&amp;$1").replace(Sd,"&lt;").replace(Td,"&gt;")),b=b.substring(d)),e=g=j=h,f.length=0,d=m);else if(i[1])be(a,i[0]);else if(i[3])j=!i[2],d=k,e=i[3].toLowerCase(),g=$.hasOwnProperty(e)?$[e]:h;else if(i[4])be(a,i[4]);else if(i[5])switch(i[5]){case "<":be(a,"&lt;");break;case ">":be(a,"&gt;");break;default:be(a,"&amp;")}}for(c=a.F.length;0<=--c;)a.N.append("</",a.F[c],">");a.F.length=0};
Od.prototype.$b=function(a){a=a.toLowerCase();if(Pd.hasOwnProperty(a))return Pd[a];var b=a.match(Yd);return b?String.fromCharCode(parseInt(b[1],10)):(b=a.match(Zd))?String.fromCharCode(parseInt(b[1],16)):""};function ce(){};/*
 Portions of this code are from the google-caja project, received by
 Google under the Apache license (http://code.google.com/p/google-caja/).
 All other code is Copyright 2009 Google, Inc. All Rights Reserved.

 // Copyright (C) 2006 Google Inc.
 //
 // Licensed under the Apache License, Version 2.0 (the "License");
 // you may not use this file except in compliance with the License.
 // You may obtain a copy of the License at
 //
 //      http://www.apache.org/licenses/LICENSE-2.0
 //
 // Unless required by applicable law or agreed to in writing, software
 // distributed under the License is distributed on an "AS IS" BASIS,
 // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 // See the License for the specific language governing permissions and
 // limitations under the License.

*/
function de(a,b){var c=new Nd;(new Od).parse(new ee(c,b,h),a);return c.toString()}function ee(a,b,c){this.N=a;this.F=[];this.R=m;this.Rb=b;this.Ma=c}qa(ee,ce);
var fe={"*::class":9,"*::dir":0,"*::id":4,"*::lang":0,"*::onclick":2,"*::ondblclick":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::style":3,"*::title":0,"*::accesskey":0,"*::tabindex":0,"*::onfocus":2,"*::onblur":2,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::rel":0,"a::rev":0,"a::shape":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,
"area::href":1,"area::nohref":0,"area::onfocus":2,"area::shape":0,"area::tabindex":0,"area::target":10,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::tabindex":0,"button::type":0,"button::value":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,
"colgroup::width":0,"del::cite":1,"del::datetime":0,"dir::compact":0,"div::align":0,"dl::compact":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,
"img::hspace":0,"img::ismap":0,"img::longdesc":1,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::autocomplete":0,"input::align":0,"input::alt":0,"input::checked":0,"input::disabled":0,"input::ismap":0,"input::maxlength":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::readonly":0,"input::size":0,"input::src":1,"input::tabindex":0,"input::type":0,"input::usemap":11,"input::value":0,
"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"ol::compact":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"p::align":0,"pre::width":0,"q::cite":1,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,
"select::onfocus":2,"select::size":0,"select::tabindex":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,
"textarea::accesskey":0,"textarea::cols":0,"textarea::disabled":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::readonly":0,"textarea::rows":0,"textarea::tabindex":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,
"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"ul::compact":0,"ul::type":0};
ee.prototype.Pb=function(a,b){if(!this.R&&$.hasOwnProperty(a)){var c=$[a];if(!(c&32))if(c&16)this.R=!(c&2);else{for(var d=b,f=0;f<d.length;f+=2){var e=d[f],g=d[f+1],j=l,i;if((i=a+"::"+e,fe.hasOwnProperty(i))||(i="*::"+e,fe.hasOwnProperty(i)))j=fe[i];if(j!==l)switch(j){case 0:break;case 2:case 3:g=l;break;case 4:case 5:case 6:case 7:case 8:case 9:g=this.Ma?this.Ma(g):g;break;case 1:g=this.Rb&&this.Rb(g);break;case 11:g&&"#"===g.charAt(0)?(g=this.Ma?this.Ma(g):g)&&(g="#"+g):g=l;break;default:g=l}else g=
l;d[f+1]=g}if(b=d){c&2||this.F.push(a);this.N.append("<",a);c=0;for(d=b.length;c<d;c+=2)f=b[c],e=b[c+1],e!==l&&e!==h&&this.N.append(" ",f,'="',e.replace(Qd,"&amp;").replace(Sd,"&lt;").replace(Td,"&gt;").replace(Ud,"&#34;").replace(Vd,"&#61;"),'"');this.N.append(">")}}}};
ee.prototype.Eb=function(a){if(this.R)this.R=m;else if($.hasOwnProperty(a)){var b=$[a];if(!(b&50)){if(b&1)for(b=this.F.length;0<=--b;){var c=this.F[b];if(c===a)break;if(!($[c]&1))return}else for(b=this.F.length;0<=--b&&!(this.F[b]===a););if(!(0>b)){for(var d=this.F.length;--d>b;)c=this.F[d],$[c]&1||this.N.append("</",c,">");this.F.length=b;this.N.append("</",a,">")}}}};function be(a,b){a.R||a.N.append(b)}ee.prototype.Nb=function(a){this.R||this.N.append(a)};ee.prototype.Bb=function(a){this.R||this.N.append(a)};function W(a){this.element=M(ge);this.f=a;this.Ub=a.getItem();this.wa=N(".annotorious-editor-text",this.element)[0];this.Sb=N(".annotorious-editor-button-cancel",this.element)[0];this.rb=N(".annotorious-editor-button-save",this.element)[0];this.Tb=ic(this.rb);this.na=[];var b=this;w(this.Sb,"click",function(c){c.preventDefault();a.stopSelection(b.zb);b.close()});w(this.rb,"click",function(c){c.preventDefault();c=b.Fb();a.r(c);a.stopSelection();b.zb?a.fireEvent(he,c):a.fireEvent(ie,c);b.close()});
U(this.element,m);a.element.appendChild(this.element);this.wa.focus()}o=W.prototype;o.eb=function(a){var b=cc("div","annotorious-editor-field");t(a)?b.innerHTML=a:u(a)?this.na.push({t:b,ib:a}):hc(a)&&b.appendChild(a);a=this.Tb;a.parentNode&&a.parentNode.insertBefore(b,a)};o.open=function(a){if(this.Ca=this.zb=a)this.wa.value=a.text;U(this.element,k);this.wa.focus();v(this.na,function(b){var c=b.ib(a);t(c)?b.t.innerHTML=c:hc(c)&&(fc(b.t),b.t.appendChild(c))})};
o.close=function(){U(this.element,m);this.wa.value=""};o.Z=function(a){Qc(this.element,a.x,a.y)};o.Fb=function(){var a=de(this.wa.value,function(a){return a});this.Ca?this.Ca.text=a:this.Ca=new Kd(this.Ub.src,a,this.f.V().getShape());return this.Ca};W.prototype.addField=W.prototype.eb;W.prototype.getAnnotation=W.prototype.Fb;function dd(){this.oa=[]}dd.prototype.h=function(a,b){this.oa[a]||(this.oa[a]=[]);this.oa[a].push(b)};dd.prototype.ja=function(a,b){var c=this.oa[a];c&&z(c,b)};dd.prototype.fireEvent=function(a,b){var c=this.oa[a];c&&v(c,function(a){a(b)})};var jd="onMouseOverItem",kd="onMouseOutOfItem",sd="onMouseOverAnnotation",ud="onMouseOutOfAnnotation",Fd="onSelectionStarted",md="onSelectionCanceled",ld="onSelectionCompleted",td="beforePopupHide",ie="onAnnotationCreated",he="onAnnotationUpdated",je={};function id(a,b,c){var d=this;c||(c="Click and Drag to Annotate");this.element=M(ke,{nb:c});this.f=a;this.vb=N(".annotorious-hint-msg",this.element)[0];this.ub=N(".annotorious-hint-icon",this.element)[0];this.bb=function(){d.show()};this.ab=function(){le(d)};this.Qa();le(this);b.appendChild(this.element)}
id.prototype.Qa=function(){var a=this;this.xb=w(this.ub,"mouseover",function(){a.show();window.clearTimeout(a.Xa)});this.wb=w(this.ub,"mouseout",function(){le(a)});this.f.h(jd,this.bb);this.f.h(kd,this.ab)};id.prototype.Va=function(){Na(this.xb);Na(this.wb);this.f.ja(jd,this.bb);this.f.ja(kd,this.ab)};id.prototype.show=function(){window.clearTimeout(this.Xa);T(this.vb,0.8);var a=this;this.Xa=window.setTimeout(function(){le(a)},3E3)};function le(a){window.clearTimeout(a.Xa);T(a.vb,0)};window.annotorious||(window.annotorious={});window.annotorious.plugin||(window.annotorious.plugin={});function V(a){this.element=M(me);this.f=a;this.Vb=N(".annotorious-popup-text",this.element)[0];this.G=N(".annotorious-popup-buttons",this.element)[0];this.Ua=m;this.na=[];var b=N(".annotorious-popup-button-edit",this.G)[0],c=N(".annotorious-popup-button-delete",this.G)[0],d=this;w(b,"mouseover",function(){Nb(b,"annotorious-popup-button-active")});w(b,"mouseout",function(){Pb(b,"annotorious-popup-button-active")});w(b,"click",function(){T(d.element,0);Q(d.element,"pointer-events","none");a.Db(d.c)});
w(c,"mouseover",function(){Nb(c,"annotorious-popup-button-active")});w(c,"mouseout",function(){Pb(c,"annotorious-popup-button-active")});w(c,"click",function(){T(d.element,0);Q(d.element,"pointer-events","none");a.fireEvent("onAnnotationRemoved",d.c);a.o(d.c)});w(this.element,"mouseover",function(){window.clearTimeout(d.Ta);0.9>(d.G.style[bb("opacity")]||"")&&T(d.G,0.9);vd(d)});w(this.element,"mouseout",function(){T(d.G,0);X(d)});a.h(je.dc,function(){X(d)});T(this.G,0);T(this.element,0);Q(this.element,
"pointer-events","none");a.element.appendChild(this.element)}V.prototype.eb=function(a){var b=cc("div","annotorious-popup-field");t(a)?b.innerHTML=a:u(a)?this.na.push({t:b,ib:a}):hc(a)&&b.appendChild(a);this.element.appendChild(b)};function X(a){a.Ua=m;a.sa||(a.sa=window.setTimeout(function(){a.f.fireEvent(td,a);a.Ua||(T(a.element,0),Q(a.element,"pointer-events","none"),T(a.G,0.9),delete a.sa)},300))}function vd(a){a.Ua=k;a.sa&&(window.clearTimeout(a.sa),delete a.sa)}
V.prototype.show=function(a,b){vd(this);if(a&&b){this.c=a;this.Vb.innerHTML=a.text?a.text.replace(/\n/g,"<br/>"):'<span class="annotorious-popup-empty">No comment</span>';"editable"in a&&a.editable==m?U(this.G,m):U(this.G,k);this.Z(b);this.Ta&&window.clearTimeout(this.Ta);T(this.G,0.9);var c=this;this.Ta=window.setTimeout(function(){T(c.G,0)},1E3);v(this.na,function(b){var c=b.ib(a);t(c)?b.t.innerHTML=c:hc(c)&&(fc(b.t),b.t.appendChild(c))})}T(this.element,0.9);Q(this.element,"pointer-events","auto")};
V.prototype.Z=function(a){Qc(this.element,new Sb(a.x,a.y))};V.prototype.addField=V.prototype.eb;H&&L(8);function ne(a){return"object"===typeof a&&a&&0===a.ic?a.content:(""+a).replace(oe,pe)}var qe={"\x00":"&#0;",'"':"&quot;","&":"&amp;","'":"&#39;","<":"&lt;",">":"&gt;","\t":"&#9;","\n":"&#10;","\x0B":"&#11;","\u000c":"&#12;","\r":"&#13;"," ":"&#32;","-":"&#45;","/":"&#47;","=":"&#61;","`":"&#96;","\u0085":"&#133;","\u00a0":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"};function pe(a){return qe[a]}var oe=/[\x00\x22\x26\x27\x3c\x3e]/g;function me(){return'<div class="annotorious-popup" style="position:absolute;z-index:1"><div class="annotorious-popup-buttons"><a class="annotorious-popup-button annotorious-popup-button-edit" title="Edit" href="javascript:void(0);">EDIT</a><a class="annotorious-popup-button annotorious-popup-button-delete" title="Delete" href="javascript:void(0);">DELETE</a></div><span class="annotorious-popup-text"></span></div>'}
function ge(){return'<div class="annotorious-editor" style="position:absolute;z-index:1"><form><textarea class="annotorious-editor-text" placeholder="Add a Comment..." tabindex="1"></textarea><div class="annotorious-editor-button-container"><a class="annotorious-editor-button annotorious-editor-button-cancel" href="javascript:void(0);" tabindex="3">Cancel</a><a class="annotorious-editor-button annotorious-editor-button-save" href="javascript:void(0);" tabindex="2">Save</a></div></form></div>'};function fd(a){return'<canvas class="annotorious-item annotorious-opacity-fade" style="position:absolute; top:0px; left:0px; width:'+ne(a.width)+"px; height:"+ne(a.height)+'px; z-index:0" width="'+ne(a.width)+'" height="'+ne(a.height)+'"></canvas>'}
function ke(a){return'<div class="annotorious-hint" style="white-space:nowrap; position:absolute; top:0px; left:0px; pointer-events:none;"><div class="annotorious-hint-msg annotorious-opacity-fade">'+ne(a.nb)+'</div><div class="annotorious-hint-icon" style="pointer-events:auto"></div></div>'};function Ad(a){return'<div class="annotorious-opacity-fade" style="white-space:nowrap; position:absolute; pointer-events:none; top:80px; width:100%; text-align:center;"><div class="annotorious-ol-hint annotorious-ol-hint-secondary" style="width: 400px; margin:0px auto;">'+ne(a.nb)+"</dvi></div>"};
